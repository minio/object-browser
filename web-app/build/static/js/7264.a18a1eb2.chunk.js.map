{"version":3,"file":"static/js/7264.a18a1eb2.chunk.js","mappings":"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","sources":["screens/Console/Common/FormComponents/InputUnitMenu/InputUnitMenu.tsx","screens/Console/Buckets/BucketDetails/EnableQuota.tsx","screens/Console/Common/ModalWrapper/ModalWrapper.tsx"],"sourcesContent":["// This file is part of MinIO Console Server\n// Copyright (c) 2021 MinIO, Inc.\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU Affero General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU Affero General Public License for more details.\n//\n// You should have received a copy of the GNU Affero General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport React, { Fragment } from \"react\";\nimport { DropdownSelector, SelectorType } from \"mds\";\nimport styled from \"styled-components\";\nimport get from \"lodash/get\";\n\ninterface IInputUnitBox {\n  id: string;\n  unitSelected: string;\n  unitsList: SelectorType[];\n  disabled?: boolean;\n  onUnitChange?: (newValue: string) => void;\n}\n\nconst UnitMenuButton = styled.button(({ theme }) => ({\n  border: `1px solid ${get(theme, \"borderColor\", \"#E2E2E2\")}`,\n  borderRadius: 3,\n  color: get(theme, \"secondaryText\", \"#5B5C5C\"),\n  backgroundColor: get(theme, \"boxBackground\", \"#FBFAFA\"),\n  fontSize: 12,\n}));\n\nconst InputUnitMenu = ({\n  id,\n  unitSelected,\n  unitsList,\n  disabled = false,\n  onUnitChange,\n}: IInputUnitBox) => {\n  const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\n  const open = Boolean(anchorEl);\n  const handleClick = (event: React.MouseEvent<HTMLElement>) => {\n    setAnchorEl(event.currentTarget);\n  };\n  const handleClose = (newUnit: string) => {\n    setAnchorEl(null);\n    if (newUnit !== \"\" && onUnitChange) {\n      onUnitChange(newUnit);\n    }\n  };\n\n  return (\n    <Fragment>\n      <UnitMenuButton\n        id={`${id}-button`}\n        aria-controls={`${id}-menu`}\n        aria-haspopup=\"true\"\n        aria-expanded={open ? \"true\" : undefined}\n        onClick={handleClick}\n        disabled={disabled}\n        type={\"button\"}\n      >\n        {unitSelected}\n      </UnitMenuButton>\n      <DropdownSelector\n        id={\"upload-main-menu\"}\n        options={unitsList}\n        selectedOption={\"\"}\n        onSelect={(value) => handleClose(value)}\n        hideTriggerAction={() => {\n          handleClose(\"\");\n        }}\n        open={open}\n        anchorEl={anchorEl}\n        anchorOrigin={\"end\"}\n      />\n    </Fragment>\n  );\n};\n\nexport default InputUnitMenu;\n","// This file is part of MinIO Console Server\n// Copyright (c) 2021 MinIO, Inc.\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU Affero General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU Affero General Public License for more details.\n//\n// You should have received a copy of the GNU Affero General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport React, { useEffect, useState } from \"react\";\nimport {\n  BucketQuotaIcon,\n  Button,\n  FormLayout,\n  InputBox,\n  Switch,\n  Grid,\n  ProgressBar,\n} from \"mds\";\nimport {\n  calculateBytes,\n  getBytes,\n  k8sScalarUnitsExcluding,\n} from \"../../../../common/utils\";\n\nimport { modalStyleUtils } from \"../../Common/FormComponents/common/styleLibrary\";\nimport ModalWrapper from \"../../Common/ModalWrapper/ModalWrapper\";\nimport InputUnitMenu from \"../../Common/FormComponents/InputUnitMenu/InputUnitMenu\";\n\nimport { setModalErrorSnackMessage } from \"../../../../systemSlice\";\nimport { useAppDispatch } from \"../../../../store\";\nimport { BucketQuota } from \"api/consoleApi\";\nimport { api } from \"api\";\nimport { errorToHandler } from \"api/errors\";\n\ninterface IEnableQuotaProps {\n  open: boolean;\n  enabled: boolean;\n  cfg: BucketQuota | null;\n  selectedBucket: string;\n  closeModalAndRefresh: () => void;\n}\n\nconst EnableQuota = ({\n  open,\n  enabled,\n  cfg,\n  selectedBucket,\n  closeModalAndRefresh,\n}: IEnableQuotaProps) => {\n  const dispatch = useAppDispatch();\n  const [loading, setLoading] = useState<boolean>(false);\n  const [quotaEnabled, setQuotaEnabled] = useState<boolean>(false);\n  const [quotaSize, setQuotaSize] = useState<string>(\"1\");\n  const [quotaUnit, setQuotaUnit] = useState<string>(\"Ti\");\n  const [validInput, setValidInput] = useState<boolean>(false);\n\n  useEffect(() => {\n    if (enabled) {\n      setQuotaEnabled(true);\n      if (cfg) {\n        const unitCalc = calculateBytes(cfg.quota || 0, true, false, true);\n\n        setQuotaSize(unitCalc.total.toString());\n        setQuotaUnit(unitCalc.unit);\n        setValidInput(true);\n      }\n    }\n  }, [enabled, cfg]);\n\n  useEffect(() => {\n    const valRegExp = /^\\d*(?:\\.\\d{1,2})?$/;\n\n    if (!quotaEnabled) {\n      setValidInput(true);\n      return;\n    }\n\n    setValidInput(valRegExp.test(quotaSize));\n  }, [quotaEnabled, quotaSize]);\n\n  const enableBucketEncryption = () => {\n    if (loading || !validInput) {\n      return;\n    }\n\n    api.buckets\n      .setBucketQuota(selectedBucket, {\n        enabled: quotaEnabled,\n        amount: parseInt(getBytes(quotaSize, quotaUnit, true)),\n        quota_type: \"hard\",\n      })\n      .then(() => {\n        setLoading(false);\n        closeModalAndRefresh();\n      })\n      .catch((err) => {\n        setLoading(false);\n        dispatch(setModalErrorSnackMessage(errorToHandler(err.error)));\n      });\n  };\n\n  return (\n    <ModalWrapper\n      modalOpen={open}\n      onClose={() => {\n        closeModalAndRefresh();\n      }}\n      title=\"Enable Bucket Quota\"\n      titleIcon={<BucketQuotaIcon />}\n    >\n      <form\n        noValidate\n        autoComplete=\"off\"\n        onSubmit={(e: React.FormEvent<HTMLFormElement>) => {\n          e.preventDefault();\n          enableBucketEncryption();\n        }}\n      >\n        <FormLayout withBorders={false} containerPadding={false}>\n          <Switch\n            value=\"bucket_quota\"\n            id=\"bucket_quota\"\n            name=\"bucket_quota\"\n            checked={quotaEnabled}\n            onChange={(event: React.ChangeEvent<HTMLInputElement>) => {\n              setQuotaEnabled(event.target.checked);\n            }}\n            label={\"Enabled\"}\n          />\n          {quotaEnabled && (\n            <InputBox\n              id=\"quota_size\"\n              name=\"quota_size\"\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n                setQuotaSize(e.target.value);\n                if (!e.target.validity.valid) {\n                  setValidInput(false);\n                } else {\n                  setValidInput(true);\n                }\n              }}\n              label=\"Quota\"\n              value={quotaSize}\n              required\n              min=\"1\"\n              overlayObject={\n                <InputUnitMenu\n                  id={\"quota_unit\"}\n                  onUnitChange={(newValue) => {\n                    setQuotaUnit(newValue);\n                  }}\n                  unitSelected={quotaUnit}\n                  unitsList={k8sScalarUnitsExcluding([\"Ki\"])}\n                  disabled={false}\n                />\n              }\n              error={!validInput ? \"Please enter a valid quota\" : \"\"}\n            />\n          )}\n          <Grid item xs={12} sx={modalStyleUtils.modalButtonBar}>\n            <Button\n              id={\"cancel\"}\n              type=\"button\"\n              variant=\"regular\"\n              disabled={loading}\n              onClick={() => {\n                closeModalAndRefresh();\n              }}\n              label={\"Cancel\"}\n            />\n\n            <Button\n              id={\"save\"}\n              type=\"submit\"\n              variant=\"callAction\"\n              disabled={loading || !validInput}\n              label={\"Save\"}\n            />\n          </Grid>\n          {loading && (\n            <Grid item xs={12}>\n              <ProgressBar />\n            </Grid>\n          )}\n        </FormLayout>\n      </form>\n    </ModalWrapper>\n  );\n};\n\nexport default EnableQuota;\n","// This file is part of MinIO Console Server\n// Copyright (c) 2021 MinIO, Inc.\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU Affero General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU Affero General Public License for more details.\n//\n// You should have received a copy of the GNU Affero General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\nimport React, { useEffect, useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { ModalBox, Snackbar } from \"mds\";\nimport { CSSObject } from \"styled-components\";\nimport { AppState, useAppDispatch } from \"../../../../store\";\nimport { setModalSnackMessage } from \"../../../../systemSlice\";\nimport MainError from \"../MainError/MainError\";\n\ninterface IModalProps {\n  onClose: () => void;\n  modalOpen: boolean;\n  title: string | React.ReactNode;\n  children: any;\n  wideLimit?: boolean;\n  titleIcon?: React.ReactNode;\n  iconColor?: \"default\" | \"delete\" | \"accept\";\n  sx?: CSSObject;\n}\n\nconst ModalWrapper = ({\n  onClose,\n  modalOpen,\n  title,\n  children,\n  wideLimit = true,\n  titleIcon = null,\n  iconColor = \"default\",\n  sx,\n}: IModalProps) => {\n  const dispatch = useAppDispatch();\n  const [openSnackbar, setOpenSnackbar] = useState<boolean>(false);\n\n  const modalSnackMessage = useSelector(\n    (state: AppState) => state.system.modalSnackBar,\n  );\n\n  useEffect(() => {\n    dispatch(setModalSnackMessage(\"\"));\n  }, [dispatch]);\n\n  useEffect(() => {\n    if (modalSnackMessage) {\n      if (modalSnackMessage.message === \"\") {\n        setOpenSnackbar(false);\n        return;\n      }\n      // Open SnackBar\n      if (modalSnackMessage.type !== \"error\") {\n        setOpenSnackbar(true);\n      }\n    }\n  }, [modalSnackMessage]);\n\n  const closeSnackBar = () => {\n    setOpenSnackbar(false);\n    dispatch(setModalSnackMessage(\"\"));\n  };\n\n  let message = \"\";\n\n  if (modalSnackMessage) {\n    message = modalSnackMessage.detailedErrorMsg;\n    if (message === \"\" || (message && message.length < 5)) {\n      message = modalSnackMessage.message;\n    }\n  }\n\n  return (\n    <ModalBox\n      onClose={onClose}\n      open={modalOpen}\n      title={title}\n      titleIcon={titleIcon}\n      widthLimit={wideLimit}\n      sx={sx}\n      iconColor={iconColor}\n    >\n      <MainError isModal={true} />\n      <Snackbar\n        onClose={closeSnackBar}\n        open={openSnackbar}\n        message={message}\n        mode={\"inline\"}\n        variant={modalSnackMessage.type === \"error\" ? \"error\" : \"default\"}\n        autoHideDuration={modalSnackMessage.type === \"error\" ? 10 : 5}\n        condensed\n      />\n      {children}\n    </ModalBox>\n  );\n};\n\nexport default ModalWrapper;\n"],"names":["UnitMenuButton","styled","button","_ref","theme","border","concat","get","borderRadius","color","backgroundColor","fontSize","_ref2","id","unitSelected","unitsList","disabled","onUnitChange","anchorEl","setAnchorEl","React","open","Boolean","handleClose","newUnit","_jsxs","Fragment","children","_jsx","undefined","onClick","event","currentTarget","type","DropdownSelector","options","selectedOption","onSelect","value","hideTriggerAction","anchorOrigin","enabled","cfg","selectedBucket","closeModalAndRefresh","dispatch","useAppDispatch","loading","setLoading","useState","quotaEnabled","setQuotaEnabled","quotaSize","setQuotaSize","quotaUnit","setQuotaUnit","validInput","setValidInput","useEffect","unitCalc","calculateBytes","quota","total","toString","unit","test","ModalWrapper","modalOpen","onClose","title","titleIcon","BucketQuotaIcon","noValidate","autoComplete","onSubmit","e","preventDefault","api","buckets","setBucketQuota","amount","parseInt","getBytes","quota_type","then","catch","err","setModalErrorSnackMessage","errorToHandler","error","FormLayout","withBorders","containerPadding","Switch","name","checked","onChange","target","label","InputBox","validity","valid","required","min","overlayObject","InputUnitMenu","newValue","k8sScalarUnitsExcluding","Grid","item","xs","sx","modalStyleUtils","modalButtonBar","Button","variant","ProgressBar","wideLimit","iconColor","openSnackbar","setOpenSnackbar","modalSnackMessage","useSelector","state","system","modalSnackBar","setModalSnackMessage","message","detailedErrorMsg","length","ModalBox","widthLimit","MainError","isModal","Snackbar","closeSnackBar","mode","autoHideDuration","condensed"],"sourceRoot":""}